<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canlƒ± Texas Hold'em Poker (Coded by Gemini)</title>
    <style>
        /* --- CSS TASARIMI (Aynƒ± Tasarƒ±m) --- */
        :root {
            --felt-color: #27ae60;
            --wood-color: #5d4037;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #2c3e50;
            background-image: radial-gradient(circle, #34495e 10%, transparent 10%), radial-gradient(circle, #34495e 10%, transparent 10%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
            user-select: none; /* Metin se√ßimini engelle */
        }

        h1 { margin: 10px 0; text-shadow: 2px 2px 4px #000; font-size: 1.8rem;}

        #poker-table {
            background-color: var(--felt-color);
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 20.5V18H0v2.5h20zM20 22v-2.5H0V22h20zM40 20.5V18H20v2.5h20zM40 22v-2.5H20V22h20zM20 0v2.5H0V0h20zM20 1.5V4H0V1.5h20zM40 0v2.5H20V0h20zM40 1.5V4H20V1.5h20zM20 40v-2.5H0V40h20zM20 38.5V36H0v2.5h20zM40 40v-2.5H20V40h20zM40 38.5V36H20v2.5h20z' fill='%231e8449' fill-opacity='0.15' fill-rule='evenodd'/%3E%3C/svg%3E");
            border: 12px solid var(--wood-color);
            border-radius: 80px;
            width: 95%;
            max-width: 700px;
            height: 450px;
            position: relative;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5), 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 15px;
            perspective: 1000px;
        }

        .hand-area, .community-area {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }

        .community-area {
            background-color: rgba(0,0,0,0.15);
            border-radius: 50px;
            padding: 5px 20px;
            margin: 0 auto;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .card-container {
            width: 60px;
            height: 90px;
            margin: 0 4px;
            position: relative;
            animation: dealCard 0.5s cubic-bezier(0.23, 1, 0.32, 1) forwards;
            opacity: 0;
            transform: translateY(-200px) rotate(720deg);
        }

        @keyframes dealCard {
            to { opacity: 1; transform: translateY(0) rotate(0deg); }
        }

        .card {
            width: 100%;
            height: 100%;
            background-color: #ecf0f1;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
            position: absolute;
            top: 0; left: 0;
            backface-visibility: hidden;
            transition: transform 0.6s;
        }

        .card-face { z-index: 2; transform: rotateY(0deg); }
        .card.red { color: #c0392b; }
        .card.black { color: #2c3e50; }

        .card-back {
            z-index: 1;
            background: repeating-linear-gradient(45deg, #c0392b, #c0392b 5px, #e74c3c 5px, #e74c3c 10px);
            border: 3px solid white;
            transform: rotateY(180deg);
        }

        .reveal-card .card-back { transform: rotateY(0deg); z-index: 0; }
        .reveal-card .card-face { transform: rotateY(-180deg); z-index: 3; }
        
        #controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background: linear-gradient(to bottom, #f39c12, #d35400);
            border: 2px solid #b84c00;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            transition: all 0.2s;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow: 0 4px #9e4100;
        }
        
        button:active { box-shadow: 0 1px #9e4100; transform: translateY(3px); }
        button:hover:not(:disabled) { filter: brightness(1.1); }
        button:disabled { background: #7f8c8d; border-color: #586667; color: #bdc3c7; box-shadow: none; cursor: not-allowed; transform: none;}

        #status-msg {
            font-size: 1.1em;
            margin-bottom: 15px;
            background: rgba(0,0,0,0.7);
            padding: 8px 20px;
            border-radius: 20px;
            min-width: 250px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .label {
            position: absolute;
            color: rgba(255,255,255,0.6);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(0,0,0,0.3);
            padding: 2px 5px;
            border-radius: 4px;
        }
        #cpu-label { top: 10px; left: 50%; transform: translateX(-50%); }
        #player-label { bottom: 10px; left: 50%; transform: translateX(-50%); }

    </style>
</head>
<body>

    <h1>Canlƒ± Texas Hold'em</h1>
    
    <div id="status-msg">Oyuna ba≈ülamak i√ßin 'Daƒüƒ±t' butonuna bas.</div>

    <div id="poker-table">
        <div id="cpu-label" class="label">Bilgisayar</div>
        <div id="cpu-hand" class="hand-area"></div>
        <div id="community-cards" class="community-area"></div>
        <div id="player-hand" class="hand-area"></div>
        <div id="player-label" class="label">Senin Elin</div>
    </div>

    <div id="controls">
        <button id="btn-deal" onclick="startGame()">Daƒüƒ±t</button>
        <button id="btn-next" onclick="nextStep()" disabled>Check (Devam)</button>
        <button id="btn-fold" onclick="fold()" disabled>Pas (Fold)</button>
    </div>

    <script>
        /* --- SES MOTORU (WEB AUDIO API) --- */
        // Dosya kullanmak yerine sesi matematiksel olarak √ºretiyoruz.
        // Bu, tarayƒ±cƒ± engellerini a≈üar ve %100 √ßalƒ±≈üƒ±r.
        
        let audioCtx = null;

        function initAudio() {
            if (!audioCtx) {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                audioCtx = new AudioContext();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        // Basit bip/ton sesi √ºreten fonksiyon
        function playTone(freq, type, duration, delay = 0) {
            if (!audioCtx) return;
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            osc.type = type; // 'sine', 'square', 'triangle'
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime + delay);
            
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime + delay);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + delay + duration);

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            osc.start(audioCtx.currentTime + delay);
            osc.stop(audioCtx.currentTime + delay + duration);
        }

        // Hƒ±≈üƒ±rtƒ± sesi (Kart sesi i√ßin)
        function playNoise(duration) {
            if (!audioCtx) return;
            const bufferSize = audioCtx.sampleRate * duration;
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);

            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }

            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            const gainNode = audioCtx.createGain();
            
            // Filtre ekleyerek sesi yumu≈üatalƒ±m (kaƒüƒ±t sesi gibi)
            const filter = audioCtx.createBiquadFilter();
            filter.type = 'lowpass';
            filter.frequency.value = 1000;

            gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);

            noise.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            noise.start();
        }

        // Olay Bazlƒ± Sesler
        const sounds = {
            click: () => playTone(800, 'sine', 0.1),
            deal: () => playNoise(0.15), // Kaƒüƒ±t hƒ±≈üƒ±rtƒ±sƒ±
            win: () => {
                // Maj√∂r akor
                playTone(523.25, 'triangle', 0.3, 0);   // C5
                playTone(659.25, 'triangle', 0.3, 0.1); // E5
                playTone(783.99, 'triangle', 0.6, 0.2); // G5
            },
            lose: () => {
                // H√ºz√ºnl√º sesler
                playTone(400, 'sawtooth', 0.4, 0);
                playTone(300, 'sawtooth', 0.6, 0.3);
            }
        };


        /* --- OYUN MANTIƒûI --- */

        const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
        const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        
        let deck = [];
        let playerHand = [];
        let cpuHand = [];
        let communityCards = [];
        let stage = 0;
        let cpuCardElements = []; 

        function createDeck() {
            deck = [];
            for (let s of suits) {
                for (let v of values) {
                    deck.push({ suit: s, value: v, weight: values.indexOf(v) + 2 });
                }
            }
        }

        function shuffleDeck() {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function createCardHTML(card, isCpu = false) {
            const container = document.createElement('div');
            container.className = 'card-container';
            container.style.animationDelay = `${Math.random() * 0.2}s`;

            const cardFace = document.createElement('div');
            cardFace.className = 'card card-face';
            if (card.suit === '‚ô•' || card.suit === '‚ô¶') cardFace.classList.add('red');
            else cardFace.classList.add('black');
            cardFace.innerHTML = `<div>${card.value}</div><div>${card.suit}</div>`;

            const cardBack = document.createElement('div');
            cardBack.className = 'card card-back';

            container.appendChild(cardBack);
            container.appendChild(cardFace);
            
            if (isCpu) {
                container.classList.add('reveal-card');
                cpuCardElements.push(container);
            }
            return container;
        }

        async function dealCardsWithAnimation(cards, targetElement, isCpu = false) {
            targetElement.innerHTML = '';
            for (const card of cards) {
                const cardEl = createCardHTML(card, isCpu);
                targetElement.appendChild(cardEl);
                sounds.deal(); // Ses burada √ßaƒürƒ±lƒ±yor
                await new Promise(r => setTimeout(r, 200));
            }
        }

        async function startGame() {
            initAudio(); // Tarayƒ±cƒ± ses motorunu ba≈ülat
            sounds.click();
            
            updateStatus("Kartlar karƒ±≈ütƒ±rƒ±lƒ±yor ve daƒüƒ±tƒ±lƒ±yor...");
            document.getElementById('btn-deal').disabled = true;
            
            createDeck();
            shuffleDeck();
            playerHand = [deck.pop(), deck.pop()];
            cpuHand = [deck.pop(), deck.pop()];
            communityCards = [];
            cpuCardElements = [];
            stage = 1;

            document.getElementById('community-cards').innerHTML = '';

            await dealCardsWithAnimation(playerHand, document.getElementById('player-hand'), false);
            await dealCardsWithAnimation(cpuHand, document.getElementById('cpu-hand'), true);

            updateStatus("Sƒ±ra sende. Devam etmek i√ßin 'Check' yap.");
            
            document.getElementById('btn-next').disabled = false;
            document.getElementById('btn-fold').disabled = false;
            document.getElementById('btn-next').innerText = "G√∂r / Devam Et";
        }

        async function nextStep() {
            initAudio();
            sounds.click();
            document.getElementById('btn-next').disabled = true;

            let newCards = [];
            if (stage === 1) { // Flop
                newCards = [deck.pop(), deck.pop(), deck.pop()];
                stage = 2;
                updateStatus("Flop a√ßƒ±lƒ±yor...");
            } else if (stage === 2) { // Turn
                newCards = [deck.pop()];
                stage = 3;
                updateStatus("Turn kartƒ± geliyor...");
            } else if (stage === 3) { // River
                newCards = [deck.pop()];
                stage = 4;
                document.getElementById('btn-next').innerText = "Elleri A√ß (Showdown)";
                updateStatus("River (son kart) a√ßƒ±lƒ±yor!");
            } else if (stage === 4) { // Showdown
                determineWinner();
                stage = 5;
                return;
            }

            communityCards.push(...newCards);
            const communityDiv = document.getElementById('community-cards');
            for (const card of newCards) {
                const cardEl = createCardHTML(card);
                communityDiv.appendChild(cardEl);
                sounds.deal();
                await new Promise(r => setTimeout(r, 250));
            }

            if(stage < 5) {
                 document.getElementById('btn-next').disabled = false;
                 updateStatus("Sƒ±ra sende.");
            }
        }

        function fold() {
            initAudio();
            sounds.lose();
            updateStatus("Pas ge√ßtiniz. Bilgisayar kazandƒ±.");
            revealCpuCards();
            endGame();
        }

        function revealCpuCards() {
            cpuCardElements.forEach(container => {
                container.classList.remove('reveal-card');
            });
        }

        function calculateHandStrength(hand, community) {
            const allCards = hand.concat(community);
            allCards.sort((a, b) => b.weight - a.weight);
            let score = 0;
            let counts = {};
            let suitsCount = {};

            allCards.forEach(card => {
                score += card.weight;
                counts[card.value] = (counts[card.value] || 0) + 1;
                suitsCount[card.suit] = (suitsCount[card.suit] || 0) + 1;
            });
            for (let val in counts) {
                if (counts[val] === 2) score += 100;
                if (counts[val] === 3) score += 300;
                if (counts[val] === 4) score += 700;
            }
            for (let suit in suitsCount) {
                if (suitsCount[suit] >= 5) score += 500;
            }
            return score;
        }

        async function determineWinner() {
            updateStatus("Eller a√ßƒ±lƒ±yor...");
            
            for(let i = 0; i < cpuCardElements.length; i++) {
                 cpuCardElements[i].classList.remove('reveal-card');
                 sounds.deal();
                 await new Promise(r => setTimeout(r, 300));
            }

            const playerScore = calculateHandStrength(playerHand, communityCards);
            const cpuScore = calculateHandStrength(cpuHand, communityCards);

            let msg = "";
            if (playerScore > cpuScore) {
                msg = "Tebrikler! Sen Kazandƒ±n! üéâ";
                document.getElementById('status-msg').style.backgroundColor = "#27ae60";
                setTimeout(() => sounds.win(), 500); // Biraz gecikmeli zafer sesi
            } else if (cpuScore > playerScore) {
                msg = "Bilgisayar Kazandƒ±. üòî";
                document.getElementById('status-msg').style.backgroundColor = "#c0392b";
                setTimeout(() => sounds.lose(), 500);
            } else {
                msg = "Berabere! ü§ù";
                sounds.click();
            }
            updateStatus(msg);
            endGame();
        }

        function endGame() {
            document.getElementById('btn-deal').disabled = false;
            document.getElementById('btn-next').disabled = true;
            document.getElementById('btn-fold').disabled = true;
            document.getElementById('btn-next').innerText = "Check";
        }

        function updateStatus(msg) {
            document.getElementById('status-msg').innerText = msg;
            if(!msg.includes("Kazandƒ±n") && !msg.includes("Bilgisayar")) {
                document.getElementById('status-msg').style.backgroundColor = "rgba(0,0,0,0.7)";
            }
        }

    </script>
</body>
</html>
